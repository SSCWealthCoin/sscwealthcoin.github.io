<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SSCWC Chess Crypto Kings ‚Äî Matchmaking & Coach</title>
  <style>
    * { box-sizing: border-box; }
    html,body { height:100%; }
    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: #000;
      color: #fff;
      text-align: center;
      padding: 14px;
    }
    .logo-container { margin-top: 16px; display:flex; justify-content:center; }
    .logo-container img { width: 120px; border-radius: 50%; box-shadow: 0 0 60px rgba(255,215,0,.6); }
    h1 { color:#ffd700; margin:12px 0 6px; }
    h2 { color:#ffe066; font-style:italic; margin-bottom:12px; }
    .controls { display:flex; gap:8px; justify-content:center; flex-wrap:wrap; }
    .btn { padding:10px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:600; }
    .btn-pink{background:#ff42e3;color:#fff;}
    .btn-blue{background:#007bff;color:#fff;}
    .btn-green{background:#00b853;color:#fff;}
    .btn-gold{background:linear-gradient(180deg,#ffea70,#ffcc00);color:#000;font-weight:800;}
    input[type=email]{padding:10px;width:300px;max-width:76vw;border-radius:8px;border:1px solid #333;background:#111;color:#fff;text-align:center;}
    #status{margin-top:8px;color:#ccc;}
    #chessContainer{margin:18px auto;width:min(480px,92vw);padding:10px;border:2px solid #ffd700;border-radius:10px;}
    #board{display:grid;grid-template-columns:repeat(8,1fr);aspect-ratio:1;}
    .square{display:flex;align-items:center;justify-content:center;font-size:2rem;cursor:pointer;}
    .light{background:#f9d98b;}
    .dark{background:#946b32;}
    footer{margin:12px 0;color:#777;font-size:.86em;}
  </style>
</head>
<body>

<div class="logo-container">
  <img src="https://raw.githubusercontent.com/SSCWealthCoin/sscwealthcoin.github.io/main/Gifcmr3XoAA_WF-.jpeg">
</div>

<h1>SSCWC Chess Crypto Kings</h1>
<h2>The Future of Gold on Blockchain</h2>

<input id="emailInput" type="email" placeholder="Your email (for quick sign-in)">
<div>
  <button id="sendLinkBtn" class="btn btn-pink">Send Magic Link</button>
</div>

<div class="controls">
  <button id="connectWalletBtn" class="btn btn-blue">Connect Wallet</button>
  <button id="openProfileBtn" class="btn btn-gold">Open Profile</button>
  <button id="createGameBtn" class="btn btn-green">Create Game</button>
</div>

<div id="status">Initializing‚Ä¶</div>

<div id="chessContainer">
  <div id="board"></div>
</div>

<footer>¬© 2025 SSC Wealth Coin</footer>

<script type="module">

/* ======================================================
   PLATFORM UID ‚Äî CORE IDENTITY LAYER (SAFE)
   ====================================================== */
(function () {
  const KEY = "sscwc_platform_uid";
  function makeUID() {
    return "sscwc_u_" + crypto.randomUUID();
  }
  let uid = localStorage.getItem(KEY);
  if (!uid) {
    uid = makeUID();
    localStorage.setItem(KEY, uid);
  }
  window.PLATFORM_UID = uid;
  window.getPlatformUID = () => uid;
  console.log("üîê PLATFORM UID:", uid);
})();

/* ------------------ Error guards ------------------ */
window.addEventListener('error', e => {
  document.getElementById('status').textContent = 'Error: ' + e.message;
  console.error(e);
});
window.addEventListener('unhandledrejection', e => {
  document.getElementById('status').textContent = 'Unhandled rejection';
  console.error(e.reason);
});

/* ------------------ Chess (minimal render) ------------------ */
const boardEl = document.getElementById('board');
const pieces = ['‚ôú','‚ôû','‚ôù','‚ôõ','‚ôö','‚ôù','‚ôû','‚ôú'];
function renderBoard(){
  boardEl.innerHTML='';
  for(let r=0;r<8;r++){
    for(let c=0;c<8;c++){
      const d=document.createElement('div');
      d.className='square '+((r+c)%2?'dark':'light');
      if(r===0)d.textContent=pieces[c];
      if(r===1)d.textContent='‚ôü';
      if(r===6)d.textContent='‚ôô';
      if(r===7)d.textContent=['‚ôñ','‚ôò','‚ôó','‚ôï','‚ôî','‚ôó','‚ôò','‚ôñ'][c];
      boardEl.appendChild(d);
    }
  }
}
renderBoard();

/* ------------------ Email capture + UID binding ------------------ */
document.getElementById('sendLinkBtn').addEventListener('click', async ()=>{
  const email = document.getElementById('emailInput').value.trim();
  if(!email){ alert("Enter email"); return; }

  localStorage.setItem('emailForSignIn', email);
  localStorage.setItem(
    'sscwc_email_lead',
    JSON.stringify({
      email,
      platformUID: window.PLATFORM_UID,
      ts: Date.now()
    })
  );

  if(window._sendSignInLinkToEmail){
    await window._sendSignInLinkToEmail(email);
    alert("Magic link sent");
  } else {
    alert("Email saved locally (Firebase not loaded)");
  }
});

/* ------------------ Firebase (dynamic, non-breaking) ------------------ */
(async function loadFirebase(){
  try{
    const appMod = await import("https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js");
    const authMod = await import("https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js");
    const dbMod = await import("https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js");

    const app = appMod.initializeApp({
      apiKey:"AIzaSyCiU4bLmbd5pJ6sv13TAMIk4eh8Exhid4o",
      authDomain:"sscwc-chess.firebaseapp.com",
      databaseURL:"https://sscwc-chess-default-rtdb.firebaseio.com",
      projectId:"sscwc-chess"
    });

    const auth = authMod.getAuth(app);
    const db = dbMod.getDatabase(app);

    window._sendSignInLinkToEmail = async (email)=>{
      await authMod.sendSignInLinkToEmail(auth,email,{
        url:window.location.href,
        handleCodeInApp:true
      });
    };

    authMod.onAuthStateChanged(auth, user=>{
      if(user){
        document.getElementById('status').textContent =
          "Signed in: "+(user.email||"anonymous");

        try{
          const ref = dbMod.ref(
            db,
            "uid_links/"+window.PLATFORM_UID
          );
          dbMod.set(ref,{
            firebaseUID:user.uid,
            email:user.email||null,
            linkedAt:Date.now()
          });
        }catch(e){
          console.warn("UID link skipped",e);
        }
      } else {
        document.getElementById('status').textContent =
          "Not signed in";
      }
    });

  }catch(e){
    console.warn("Firebase not loaded",e);
  }
})();

/* ------------------ Buttons ------------------ */
document.getElementById('connectWalletBtn').onclick=()=>alert("Wallet placeholder");
document.getElementById('createGameBtn').onclick=()=>alert("Matchmaking placeholder");
document.getElementById('openProfileBtn').onclick=()=>{
  alert("PROFILE\nUID: "+window.PLATFORM_UID);
};

</script>
</body>
</html>
